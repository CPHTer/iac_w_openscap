init_server = """
#!/bin/bash

sudo add-apt-repository ppa:ansible/ansible-2.5
apt-get update
apt-get install libopenscap8 ssg-debian unzip nginx ansible -y

sudo adduser --quiet --disabled-password --shell /bin/bash --home /home/auditor --gecos "Auditor" auditor
echo "auditor:letmeaudit" | sudo chpasswd
sudo usermod -aG sudo auditor

mkdir /home/auditor/.ssh
sudo chown auditor:auditor /home/auditor/.ssh

sudo sh -c 'echo "-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----" > /home/auditor/.ssh/id_rsa'

sudo chown auditor:auditor /home/auditor/.ssh/id_rsa
sudo chmod 600 /home/auditor/.ssh/id_rsa

sudo sh -c 'echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCxj1kk485riQqWmZsJTQk0z1KzCwvMo28r4Bb3jAJWU2tdDiE6BADNfX2Wuw8Ha4W6P2Ryo6BaY65oq9rMBMPPV5ptkAxrmOXzxxt8Z/RR4P2riN+K2+IVTFh08/g5KLD6G2HeO7iaK782RI4YgbmEvpALXWKxqR0SmXKf79XpbgMK3CDROejDUNAOKhYN28XkesW0iLGvoGgxg3FLrvu/EZF1ekIzJmGsOa3DtG3fpx6JiDsw+XeC0O3m8KTN6BwbGnHXslyJHrBopthE2IqyMzrNqvM06c0L32hkCLciWYpc2WHfzHHzusQsdsc5KrArHUzKNbpwQqeOsPwo89B0EjioBVxA42SU6IUlkMn7x4u4Yu9ib8kQ46qebsH12V5TUfA664AfjA+viFEMtl/VSy/UL0pVKMXxIs08bYZN1PZvDlnUd8YkcHI7MQbSPCMbCxQ6c3GCsjqETS5fUCz9DLhagksb0aYsln8necqm2+T7CAvCdeaCcik0U+a8xIff/q8rHjIX4czcSuJx18kMDXMdcxBY5WAJbFN/xlhpGKh8sfwWuI+zyyvLIYhmC/8ynCZGh1+qts0HC3DsxpFnECWPY0jMSFyuSv3HWijmFcfbBJGjQnBZ9GedCTlFCUUwQff0lvJEUJyBXdrjVO6OtzbEMXSpu0r62G/XgypcxQ== auditor@policyserver" > /home/auditor/.ssh/id_rsa.pub'

sudo chown auditor:auditor /home/auditor/.ssh/id_rsa.pub
sudo chmod 600 /home/auditor/.ssh/id_rsa.pub

wget https://raw.githubusercontent.com/OpenSCAP/openscap/maint-1.3/utils/oscap-ssh
chmod 755 oscap-ssh
mv -v oscap-ssh /usr/local/bin

"""

init_client = """
#!/bin/bash

apt-get update
apt-get install libopenscap8 python -y
"""

init_client_trusted_key = """ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCxj1kk485riQqWmZsJTQk0z1KzCwvMo28r4Bb3jAJWU2tdDiE6BADNfX2Wuw8Ha4W6P2Ryo6BaY65oq9rMBMPPV5ptkAxrmOXzxxt8Z/RR4P2riN+K2+IVTFh08/g5KLD6G2HeO7iaK782RI4YgbmEvpALXWKxqR0SmXKf79XpbgMK3CDROejDUNAOKhYN28XkesW0iLGvoGgxg3FLrvu/EZF1ekIzJmGsOa3DtG3fpx6JiDsw+XeC0O3m8KTN6BwbGnHXslyJHrBopthE2IqyMzrNqvM06c0L32hkCLciWYpc2WHfzHHzusQsdsc5KrArHUzKNbpwQqeOsPwo89B0EjioBVxA42SU6IUlkMn7x4u4Yu9ib8kQ46qebsH12V5TUfA664AfjA+viFEMtl/VSy/UL0pVKMXxIs08bYZN1PZvDlnUd8YkcHI7MQbSPCMbCxQ6c3GCsjqETS5fUCz9DLhagksb0aYsln8necqm2+T7CAvCdeaCcik0U+a8xIff/q8rHjIX4czcSuJx18kMDXMdcxBY5WAJbFN/xlhpGKh8sfwWuI+zyyvLIYhmC/8ynCZGh1+qts0HC3DsxpFnECWPY0jMSFyuSv3HWijmFcfbBJGjQnBZ9GedCTlFCUUwQff0lvJEUJyBXdrjVO6OtzbEMXSpu0r62G/XgypcxQ== auditor@policyserver
"""